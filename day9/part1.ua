ğŸ’¾ â† &fras "example.txt"

Disk â† â‰ âŠŸ /(âŠ‚âŠ‚) Â¯1 â‡¡ âŒˆ Ã· 2 â§» . â‰¡â‹•

# disk pos sum ? id size disk pos sum
ProcessFile â† (
  âŠƒ(â‹…âŠ™â‹…âŠ™|âŠ™â‹…âŠ™|+âŠƒ(â‹…â‹…â‹…âŠ™|â‹…âŠ™)) # size, pos, id, disk, updated pos
  /+Ã—+â‡¡
  âŠƒ(â‹…âŠ™âŠ™|+âŠƒ(âˆ˜|â‹…â‹…â‹…âŠ™))
)

# disk ? disk
TrimEndSpace â† (
  Â°âŠŸ âœâ‡Œ Â°âŠ‚
  <0 .
  â¨¬(âŠ‚ : âŠŸ|â—Œâ—Œ)
)

# for negative spaceleft put space between file and beginning of next file on disk
# disk ? spaceleft id size disk
AddFileWithSpace â† (
  âŠƒ(âŠŸ Â¯1|âŠŸ âŠƒ(â‹…âŠ™|â‹…â‹…âŠ™))
  âŠ‚ âŠƒ(â‹…âŠ™|âŠ‚âŠƒ(âŠ™|â‹…â‹…âŠ™))
)

# for positive spaceleft put as much file as we can at start and rest back on the end
# disk ? spaceleft id size disk
SplitFile â† (
  âŠƒ(âŠŸ âŠƒ(â‹…âŠ™|+âŠ™â‹…âŠ™)|âŠŸ âŠƒ(â‹…âŠ™|Â¯âŠ™))
  âŠ‚(âŠ‚âŠƒ(âŠ™|â‹…â‹…âŠ™|â‹…âŠ™))
)

# disk  ? id size disk
RearrangeSpace â† (
  : â—Œ      # space, don't need the `1 
  Â°âŠŸ âœâ‡Œ Â°âŠ‚ # get last file info

  âŠƒ(âŠ™âŠ™|-âŠƒ(â‹…âŠ™â‹…âŠ™)|â‹…â‹…âŠ™)
  âŠƒ(â‹…â‹…âŠ™|âŠ™âŠ™)

  <0 . # does file fits with space to spare?
  â¨¬(AddFileWithSpace|SplitFile)
)

Disk ğŸ’¾ 0 0 # disk position checksum

â¢(Â°âŠŸ Â°âŠ‚
  <0 .
  â¨¬(ProcessFile|RearrangeSpace)
  TrimEndSpace
| > 1â§»
)

Â°âŠ‚
Â°âŠŸ
ProcessFile
